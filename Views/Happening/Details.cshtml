@model _250ml_MVC4_2.Models.Happening

@{
    ViewBag.Title = "Details";
}

<h2>Details</h2>

<fieldset>
    <legend>Happening</legend>

    <div class="display-label">
         @Html.DisplayNameFor(model => model.Name)
    </div>
    <div class="display-field">
        @Html.DisplayFor(model => model.Name)
    </div>

    <div class="display-label">
         @Html.DisplayNameFor(model => model.StartDate)
    </div>
    <div class="display-field">
        @Html.DisplayFor(model => model.StartDate)
    </div>

    <div class="display-label">
         @Html.DisplayNameFor(model => model.EndDate)
    </div>
    <div class="display-field">
        @Html.DisplayFor(model => model.EndDate)
    </div>
</fieldset>


    <h2>Bewertung</h2>
    @{
        int max_rating = 0;
        foreach(var rating in Model.Ratings) {
            max_rating += rating.Value;
        }

        max_rating /= Model.Ratings.Count;

   }
          &Oslash;  @max_rating

          <!-- schon gevotet? -->
          @{ if( Model.Ratings.Where(m => m.UserId == WebSecurity.CurrentUserId).ToList().Count == 0 )
             { @Html.Partial("AddRatingForm") }
          }
    


         
    <h2>Kommentare (@Model.Comments.Count)</h2>

        @{ int i = 1; }
        @foreach(var comment in Model.Comments) {
            <p>
                #@i - @comment.UserProfile.UserName hat geschrieben:
                <p>@comment.Content</p>
            
            </p>                           
            i++;
        }

    @{ 
        if ( User.Identity.IsAuthenticated ) { @Html.Partial("AddCommentForm", Model); }
    }



<p>
    @Html.ActionLink("Edit", "Edit", new { id=Model.HappeningId }) |
    @Html.ActionLink("Back to List", "Index")
</p>
